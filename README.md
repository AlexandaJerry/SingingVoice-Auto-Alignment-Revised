### 歌曲干声自动标注（Opencpop格式）

在新的词典和音素系统以及推理逻辑出来前，本项目致力于采用Opencpop原生词典，结合MFA的自动对齐功能和Praat脚本，完成跟Opencpop格式一致的自动标注。在有音频文件和对应抄本srt或者lyc文件的情况下，可以使用本项目的轮子进行标注以加快速度。项目中包含了训练好的MFA声学模型，Opencpop词典和Praat批量标注脚本。

本人期待的歌曲标注工作流如下所示：带lyrics歌词的歌曲→lyrics转为带时间戳的srt文件→歌曲经过UVR处理(在线版的人声分离网站也可)→根据srt时间戳批量截取音频和对应歌词→储存为同名wav和txt→pypinyin将歌词txt转为不带声调的汉语音节→在txt中人工添加额外SP, AP, 转音标记→MFA自动对齐→根据MFA的textgrid自动生成midi层时长层和转音层标注→在Praat中自动按顺序打开wav和同名textgrid进行人工修正→更新midi层时长层和转音层的标注

目前这个工作流已经基本实现，主要是五个轮子的配合，一个是根据srt时间戳批量截取音频和对应歌词 (我改的Github现成轮子)，一个是用pyinyin把歌词转为pinyin (这个很容易实现)，一个是转音符号-替换为韵母(主要是为了遵循Opencpop的标注格式)，一个是MFA批量标注(项目中已给出训练共300轮的声学模型和词典)，一个是自动生成midi标注和时长标注并按照人工修改更新 (基于Praat脚本实现)。

最近可能得暂停更新段时间，我得去准备论文，后续会考虑在B站以录屏形式，更新下歌曲干声自动标注流程，当然我也很期待有整合式的全流程标注软件出现。Diffsinger的合成效果蛮不错，Openvpi项目组在丰富Diffsinger原项目上做出了很大跨越。我觉得用自己喜欢的歌手或者Vup合成自己想要的歌曲，是可期待在未来实现的事，只要我们不懈努力。我赶着把简陋版自动标注项目做出来，主要是因为目前还没有看到Diffsinger用在新的歌曲干声上，再加上新学期开始后很多ddl到来，所以做的确实有些着急，就当是抛砖引玉。

※※※ 后续在操作过程中，我发现转音和SPAP这些符号其实放到"对齐后用MFA产生的双层标注在Praat中自动按顺序打开wav和同名textgrid进行人工修正"这个过程中再添加会更省力，因为到时会有Pitch曲线直观显示出转音，还有频谱图看AP。现在这种"提前在lyrics里标记转音，再把转音符号替换成韵母，最后再用Praat把转音符号改回来"的操作有点重复劳动，直接把歌词转成pinyin扔进MFA，拿到强制对齐结果后再添加SPAP和转音这些会更省时间。以后有时间再修改吧！